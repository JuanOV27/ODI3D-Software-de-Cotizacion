<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cotizaci√≥n 3D con Kiri:Moto</title>
    <link rel="stylesheet" href="css/stylecotizacion.css">
    <!-- NUEVO: Estilos de Kiri:Moto -->
    <link rel="stylesheet" href="css/kirimoto-styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="nav-back">‚Üê Volver al Men√∫</a>
            <h1>üí∞ Cotizaci√≥n de Proyectos 3D</h1>
            <p>Ahora con integraci√≥n de Kiri:Moto - Carga tus modelos STL directamente</p>
            <button class="calc-toggle-btn" onclick="toggleMobileCalc()">
                üßÆ Calculadora B√°sica
            </button>
        </div>

        <div class="main-content">
            <!-- COLUMNA DE PASOS -->
            <div class="steps-column">
                
                <!-- PASO 1: Informaci√≥n de la Pieza -->
                <div class="step-container">
                    <div class="step-number">1</div>
                    <h3 class="step-title">Informaci√≥n de la Pieza</h3>
                    
                    <div class="form-group">
                        <label for="nombrePieza">Nombre de la Pieza</label>
                        <input type="text" id="nombrePieza" placeholder="Ej: Engranaje v2.1">
                    </div>

                    <!-- 
                        NOTA: El m√≥dulo KiriMotoIntegration autom√°ticamente
                        insertar√° aqu√≠ la secci√≥n de carga de archivos STL
                        despu√©s de este primer form-group
                    -->

                    <div class="form-group">
                        <label for="pesoPieza">
                            Peso de la Pieza (g)
                            <span style="color: #059669; font-size: 0.85rem;">
                                ‚ú® Auto-completado al cargar STL
                            </span>
                        </label>
                        <input type="number" id="pesoPieza" value="50" min="0.1" step="0.1">
                    </div>

                    <div class="form-group">
                        <label for="tiempoImpresion">
                            Tiempo de Impresi√≥n (minutos)
                            <span style="color: #059669; font-size: 0.85rem;">
                                ‚ú® Auto-completado al cargar STL
                            </span>
                        </label>
                        <input type="number" id="tiempoImpresion" value="120" min="1">
                    </div>

                    <aside class="aside-help">
                        <h4>üí° Nueva Funcionalidad</h4>
                        <p>
                            <strong>üì± En m√≥vil:</strong> Carga tu archivo STL y obt√©n peso y tiempo autom√°ticamente.<br>
                            <strong>üíª En escritorio:</strong> Adem√°s puedes editar, escalar y rotar tu modelo visualmente.
                        </p>
                    </aside>
                </div>

                <!-- PASO 2: Selecci√≥n de Filamento del Inventario -->
                <div class="step-container">
                    <div class="step-number">2</div>
                    <h3 class="step-title">üßµ Filamento del Inventario</h3>
                    
                    <div class="form-group">
                        <label for="perfilFilamentoCotizacion">Perfil de Filamento</label>
                        <select id="perfilFilamentoCotizacion" onchange="cargarPerfilFilamentoEnCotizacion()">
                            <option value="">-- Seleccionar del inventario --</option>
                        </select>
                    </div>

                    <div id="infoFilamentoSeleccionado" style="display: none;">
                        <div class="filamento-info-card">
                            <div class="filamento-header">
                                <div class="color-indicator" id="colorIndicadorCotizacion"></div>
                                <div>
                                    <h4 id="tipoMarcaCotizacion" style="margin: 0; color: #4f46e5;">-</h4>
                                    <p id="colorNombreCotizacion" style="margin: 5px 0 0 0; color: #6b7280; font-size: 0.9rem;">-</p>
                                </div>
                            </div>
                            
                            <div class="filamento-disponibilidad">
                                <div class="disponibilidad-item">
                                    <span class="label">üì¶ Disponible:</span>
                                    <span class="value" id="pesoDisponibleCotizacion">0g</span>
                                </div>
                                <div class="disponibilidad-item">
                                    <span class="label">üìä Estado:</span>
                                    <span class="value" id="estadoFilamentoCotizacion">-</span>
                                </div>
                                <div class="disponibilidad-barra">
                                    <div class="barra-fondo">
                                        <div class="barra-progreso" id="barraProgresoCotizacion" style="width: 0%"></div>
                                    </div>
                                    <span class="barra-porcentaje" id="porcentajeDisponibleCotizacion">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <aside class="aside-help">
                        <h4>üí° Ayuda</h4>
                        <p>Selecciona un filamento de tu inventario para aplicar autom√°ticamente sus costos y verificar disponibilidad.</p>
                    </aside>
                    
                    <!-- NUEVO: Campos editables de Costo y Peso integrados aqu√≠ -->
                    <div class="filamento-costos-editables" style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #d1d5db;">
                        <h5 style="color: #4f46e5; margin-bottom: 15px; font-size: 1rem; font-weight: 600;">üíµ Costos del Carrete</h5>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div class="form-group" style="margin-bottom: 0;">
                                <label for="costoCarrete">Costo (COP)</label>
                                <input type="number" id="costoCarrete" value="120000" placeholder="120000" 
                                       min="0" step="1000">
                            </div>
                            <div class="form-group" style="margin-bottom: 0;">
                                <label for="pesoCarrete">Peso (kg)</label>
                                <input type="number" id="pesoCarrete" value="1" placeholder="1" 
                                       min="0.1" step="0.1">
                            </div>
                        </div>
                        
                        <p style="font-size: 0.8rem; color: #6b7280; margin-top: 10px; font-style: italic;">
                            ‚ú® Se auto-completan al seleccionar el filamento. Puedes editarlos si es necesario.
                        </p>
                    </div>
                </div>

                <!-- PASO 3: Costos de Dise√±o -->
                <div class="step-container">
                    <div class="step-number">3</div>
                    <h3 class="step-title">Costos de Dise√±o</h3>
                    
                    <div class="form-group">
                        <label for="horasDiseno">Horas de Dise√±o</label>
                        <input type="number" id="horasDiseno" value="2" min="0" step="0.5">
                    </div>

                    <div class="form-group">
                        <label for="costoHoraDiseno">Costo por Hora (COP)</label>
                        <input type="number" id="costoHoraDiseno" value="25000" min="0" step="1000">
                    </div>
                </div>

                <!-- PASO 4: Par√°metros Adicionales -->
                <div class="step-container">
                    <div class="step-number">4</div>
                    <h3 class="step-title">Par√°metros Adicionales</h3>
                    
                    <div class="form-group">
                        <label for="factorSeguridad">Factor de Seguridad</label>
                        <input type="number" id="factorSeguridad" value="1.1" min="1" step="0.1">
                    </div>

                    <div class="form-group">
                        <label for="usoElectricidad">Electricidad por Hora (COP)</label>
                        <input type="number" id="usoElectricidad" value="600" min="0" step="50">
                    </div>

                    <div class="form-group">
                        <label for="gif">GIF - Gastos Indirectos (%)</label>
                        <input type="number" id="gif" value="15" min="0" max="100" step="1">
                    </div>

                    <div class="form-group">
                        <label for="aiu">AIU - Administraci√≥n e Imprevistos (%)</label>
                        <input type="number" id="aiu" value="25" min="0" max="100" step="1">
                    </div>

                    <div class="form-group checkbox-group">
                        <label>
                            <input type="checkbox" id="incluirMarcaAgua">
                            Incluir Marca de Agua en el Modelo
                        </label>
                    </div>

                    <div class="form-group" id="grupoMarcaAgua" style="display: none;">
                        <label for="porcentajeMarcaAgua">Costo Marca de Agua (%)</label>
                        <input type="number" id="porcentajeMarcaAgua" value="10" min="0" max="50" step="1">
                    </div>
                </div>

<!-- PASO X: Costos de Postprocesado -->
<div class="step-container">
    <div class="step-number">5</div>
    <h3 class="step-title">Costos de Postprocesado</h3>
    
    <!-- Checkbox para activar/desactivar postprocesado -->
    <div class="form-group">
        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
            <input type="checkbox" 
                   id="incluirPostprocesado" 
                   style="width: 20px; height: 20px; cursor: pointer;">
            <span style="font-weight: 600;">Incluir costos de postprocesado</span>
        </label>
        <p style="font-size: 0.85rem; color: #6b7280; margin-top: 8px;">
            Activa esta opci√≥n si la pieza requiere acabados adicionales despu√©s de la impresi√≥n
        </p>
    </div>
    
    <!-- Contenedor que se muestra cuando se activa el checkbox -->
    <div id="contenedorPostprocesado" style="display: none; margin-top: 20px; padding: 20px; background: #f9fafb; border-radius: 8px; border: 1px solid #e5e7eb;">
        
        <!-- Nivel de Dificultad -->
        <div class="form-group">
            <label for="nivelDificultadPostprocesado">
                üéØ Nivel de Dificultad de Acabados
            </label>
            <select id="nivelDificultadPostprocesado" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px;">
                <option value="">Seleccione un nivel...</option>
                <option value="facil">Nivel 1 - F√°cil (COP $15,000 - $30,000)</option>
                <option value="intermedio">Nivel 2 - Intermedio (COP $45,000 - $60,000)</option>
                <option value="dificil">Nivel 3 - Dif√≠cil (COP $75,000 - $90,000)</option>
            </select>
            <p style="font-size: 0.8rem; color: #6b7280; margin-top: 6px; font-style: italic;">
                El nivel determina la complejidad del trabajo de acabado
            </p>
        </div>
        
        <!-- Costo de Mano de Obra -->
        <div class="form-group">
            <label for="costoManoObraPostprocesado">
                üí∞ Costo de Mano de Obra (COP)
            </label>
            <input type="number" 
                   id="costoManoObraPostprocesado" 
                   value="0" 
                   min="0" 
                   step="1000"
                   placeholder="Ej: 22500"
                   style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px;">
            <p id="infoRangoManoObra" style="font-size: 0.8rem; color: #059669; margin-top: 6px; font-weight: 600;">
                Seleccione un nivel de dificultad para ver el rango sugerido
            </p>
        </div>
        
        <!-- Separador -->
        <div style="border-top: 2px solid #d1d5db; margin: 25px 0;"></div>
        
        <!-- Insumos para Postprocesado -->
        <div>
            <h4 style="color: #4f46e5; margin-bottom: 12px; font-size: 1rem; display: flex; align-items: center; gap: 8px;">
                <span>üß∞</span>
                <span>Insumos para Postprocesado</span>
            </h4>
            <p style="font-size: 0.85rem; color: #6b7280; margin-bottom: 15px;">
                Selecciona los materiales que se utilizar√°n en el proceso de acabado (pintura, lija, pegamento, etc.)
            </p>
            
            <!-- Contenedor donde se renderizar√°n los insumos -->
            <div id="contenedorInsumosPostprocesado">
                <!-- Se llenar√° din√°micamente con JavaScript -->
            </div>
        </div>
        
        <!-- Resumen de Costos de Postprocesado -->
        <div style="margin-top: 20px; padding: 15px; background: white; border-radius: 8px; border: 1px solid #e5e7eb;">
            <h4 style="color: #1f2937; margin: 0 0 12px 0; font-size: 0.95rem;">
                üìä Resumen de Costos de Postprocesado
            </h4>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.9rem;">
                <div>
                    <span style="color: #6b7280;">Mano de Obra:</span>
                </div>
                <div style="text-align: right;">
                    <strong id="resumenManoObraPostprocesado" style="color: #059669;">$0</strong>
                </div>
                <div>
                    <span style="color: #6b7280;">Insumos:</span>
                </div>
                <div style="text-align: right;">
                    <strong id="resumenInsumosPostprocesado" style="color: #059669;">$0</strong>
                </div>
                <div style="border-top: 2px solid #e5e7eb; padding-top: 8px;">
                    <strong style="color: #1f2937;">Total Postprocesado:</strong>
                </div>
                <div style="text-align: right; border-top: 2px solid #e5e7eb; padding-top: 8px;">
                    <strong id="resumenTotalPostprocesado" style="color: #4f46e5; font-size: 1.1rem;">$0</strong>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Ayuda -->
    <aside class="aside-help" style="margin-top: 20px;">
        <h4>üí° Sobre el Postprocesado</h4>
        <p>
            El postprocesado incluye todos los trabajos de acabado que se realizan despu√©s de la impresi√≥n:
        </p>
        <ul style="margin-top: 10px; padding-left: 20px; font-size: 0.9rem;">
            <li><strong>Nivel F√°cil:</strong> Limpieza b√°sica, retirar soportes simples</li>
            <li><strong>Nivel Intermedio:</strong> Lijado, aplicaci√≥n de primer, acabados b√°sicos</li>
            <li><strong>Nivel Dif√≠cil:</strong> M√∫ltiples capas de pintura, detalles complejos, ensamblaje</li>
        </ul>
        <p style="margin-top: 10px; font-size: 0.85rem; color: #6b7280;">
            Los insumos se descuentan autom√°ticamente del inventario al confirmar la cotizaci√≥n.
        </p>
    </aside>
</div>

                <!-- PASO 5: Selecci√≥n de M√°quina(s) -->
<div class="step-container">
    <div class="step-number">5</div>
    <h3 class="step-title">üè≠ Selecci√≥n de M√°quina(s)</h3>
    
    <!-- Selector de Modo -->
    <div class="form-group">
        <label style="font-weight: 700; margin-bottom: 15px; display: block;">
            ¬øC√≥mo se realizar√° este trabajo?
        </label>
        
        <div class="radio-group">
            <label class="radio-option">
                <input type="radio" name="modoMaquina" value="unica" 
                       onchange="cambiarModoMaquina('unica')" checked>
                <div class="radio-content">
                    <span class="radio-icon">üñ®Ô∏è</span>
                    <div>
                        <strong>M√°quina √önica</strong>
                        <p style="font-size: 0.85rem; color: #6b7280; margin-top: 4px;">
                            Todo el pedido se realizar√° en una sola impresora
                        </p>
                    </div>
                </div>
            </label>
            
            <label class="radio-option">
                <input type="radio" name="modoMaquina" value="multiple" 
                       onchange="cambiarModoMaquina('multiple')">
                <div class="radio-content">
                    <span class="radio-icon">üè≠</span>
                    <div>
                        <strong>M√∫ltiples M√°quinas</strong>
                        <p style="font-size: 0.85rem; color: #6b7280; margin-top: 4px;">
                            Distribuir el pedido entre varias impresoras
                        </p>
                    </div>
                </div>
            </label>
        </div>
    </div>

    <!-- MODO: M√ÅQUINA √öNICA -->
    <div id="selectorMaquinaUnica" style="display: block;">
        <div class="form-group">
            <label for="maquinaSeleccionada">Seleccionar M√°quina</label>
            <select id="maquinaSeleccionada" onchange="actualizarInfoMaquina()">
                <option value="">-- Seleccionar m√°quina --</option>
                <!-- Se llenar√° din√°micamente con JavaScript -->
            </select>
        </div>

        <!-- Info de la m√°quina seleccionada -->
        <div id="infoMaquinaUnica" class="info-maquina" style="display: none;">
            <div class="info-grid">
                <div class="info-item">
                    <span class="info-label">Modelo:</span>
                    <span class="info-value" id="infoModelo">-</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Tipo:</span>
                    <span class="info-value" id="infoTipo">-</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Depreciaci√≥n/hora:</span>
                    <span class="info-value" id="infoDepreciacion">$0</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Horas de uso:</span>
                    <span class="info-value" id="infoHorasUso">0h</span>
                </div>
            </div>
            
            <div class="depreciacion-estimada">
                <span>üí∞ Depreciaci√≥n estimada para este trabajo:</span>
                <strong id="depreciacionEstimada">$0</strong>
            </div>
        </div>
    </div>

    <!-- MODO: M√öLTIPLES M√ÅQUINAS -->
    <div id="selectorMaquinasMultiples" style="display: none;">
        <p style="color: #6b7280; margin-bottom: 15px; font-size: 0.9rem;">
            Distribuye las piezas entre las m√°quinas disponibles. El sistema calcular√° 
            autom√°ticamente el promedio ponderado de depreciaci√≥n.
        </p>

        <div id="distribucionMaquinas">
            <!-- Se llenar√° din√°micamente con JavaScript -->
        </div>

        <button type="button" class="btn-secondary" onclick="agregarMaquinaDistribucion()" 
                style="margin-top: 10px; width: 100%;">
            ‚ûï Agregar M√°quina
        </button>

        <!-- Resumen de distribuci√≥n m√∫ltiple -->
        <div id="resumenDistribucion" class="info-maquina" style="display: none; margin-top: 15px;">
            <h4 style="margin-bottom: 10px; color: #1f2937;">üìä Resumen de Distribuci√≥n</h4>
            <div class="info-grid">
                <div class="info-item">
                    <span class="info-label">Total de piezas:</span>
                    <span class="info-value" id="totalPiezasDistribucion">0</span>
                </div>
                <div class="info-item">
                    <span class="info-label">M√°quinas usadas:</span>
                    <span class="info-value" id="totalMaquinasUsadas">0</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Depreciaci√≥n promedio:</span>
                    <span class="info-value" id="depreciacionPromedio">$0/h</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Depreciaci√≥n total:</span>
                    <span class="info-value" id="depreciacionTotalMultiple">$0</span>
                </div>
            </div>
        </div>
    </div>

    <aside class="aside-help">
        <h4>üí° Selecci√≥n de M√°quinas</h4>
        <p>
            <strong>M√°quina √∫nica:</strong> Ideal para pedidos peque√±os o medianos donde 
            toda la producci√≥n cabe en una sola impresora.<br><br>
            <strong>M√∫ltiples m√°quinas:</strong> Perfecto para pedidos grandes donde se 
            necesita dividir el trabajo entre varias impresoras para optimizar tiempos 
            y distribuir el desgaste.
        </p>
    </aside>
</div>


                <!-- PASO 6: Cantidad y Lotes -->
                <div class="step-container">
                    <div class="step-number">6</div>
                    <h3 class="step-title">Cantidad y Lotes</h3>
                    
                    <div class="form-group">
                        <label for="cantidadPiezas">Cantidad Total de Piezas</label>
                        <input type="number" id="cantidadPiezas" value="1" min="1">
                    </div>

                    <div class="form-group">
                        <label for="piezasPorLote">Piezas por Lote de Impresi√≥n</label>
                        <input type="number" id="piezasPorLote" value="1" min="1">
                    </div>

                    <div id="errorLote" class="error-message" style="display: none;">
                        ‚ö†Ô∏è El n√∫mero de piezas por lote no puede ser mayor que la cantidad total
                    </div>
                </div>

                <!-- PASO 7: M√°rgenes de Venta -->
                <div class="step-container">
                    <div class="step-number">7</div>
                    <h3 class="step-title">M√°rgenes de Venta</h3>
                    
                    <div class="form-group">
                        <label for="margenMinorista">Margen Minorista (%)</label>
                        <input type="number" id="margenMinorista" value="30" min="0" max="100" step="1">
                    </div>

                    <div class="form-group">
                        <label for="margenMayorista">Margen Mayorista (%)</label>
                        <input type="number" id="margenMayorista" value="20" min="0" max="100" step="1">
                    </div>
                    
                    <aside class="aside-help">
                        <h4>üí° M√°rgenes de Ganancia</h4>
                        <p>
                            Define el porcentaje de ganancia sobre el precio base para diferentes canales de venta.
                        </p>
                    </aside>
                </div>

                <!-- Bot√≥n Calcular -->
                <div class="step-container">
                    <button class="btn btn-primary btn-large" onclick="calcularPrecio()" style="width: 100%;">
                        üéØ Calcular Cotizaci√≥n
                    </button>
                </div>
            </div>

            <!-- DIVISOR REDIMENSIONABLE -->
            <div class="resizer" id="resizer"></div>

            <!-- COLUMNA DE RESULTADOS -->
            <div class="results-column">
                <h2 class="section-title">üìä Resultados de la Cotizaci√≥n</h2>
                
                <div class="results-grid">
                    <div class="result-item highlight">
                        <span class="result-label">üí∞ Precio Base por Pieza:</span>
                        <span class="result-value" id="precioFinal">$0</span>
                    </div>
                    
                    <div class="result-item">
                        <span class="result-label">üè≠ Costo Fabricaci√≥n:</span>
                        <span class="result-value" id="costoFabricacion">$0</span>
                    </div>
                    
                    <div class="result-item">
                        <span class="result-label">‚ö° Costo Energ√≠a:</span>
                        <span class="result-value" id="costoEnergia">$0</span>
                    </div>
                    
                    <div class="result-item">
                        <span class="result-label">üé® Costo Dise√±o:</span>
                        <span class="result-value" id="costoDiseno">$0</span>
                    </div>
                    
                    <div class="result-item">
                        <span class="result-label">üîß Depreciaci√≥n M√°quina:</span>
                        <span class="result-value" id="depreciacionMaquina">$0</span>
                    </div>
                    
                    <div class="result-item">
                        <span class="result-label">üìà Gastos Indirectos (GIF):</span>
                        <span class="result-value" id="costoGIF">$0</span>
                    </div>
                    
                    <div class="result-item">
                        <span class="result-label">üõ°Ô∏è AIU:</span>
                        <span class="result-value" id="costoAIU">$0</span>
                    </div>
                    
                    <div class="result-item" id="itemMarcaAgua" style="display: none;">
                        <span class="result-label">üè∑Ô∏è Marca de Agua:</span>
                        <span class="result-value" id="costoMarcaAguaDisplay">$0</span>
                    </div>
                    
                    <div class="result-item highlight">
                        <span class="result-label">üíµ Precio Minorista:</span>
                        <span class="result-value" id="precioMinorista">$0</span>
                    </div>
                    
                    <div class="result-item highlight">
                        <span class="result-label">üè™ Precio Mayorista:</span>
                        <span class="result-value" id="precioMayorista">$0</span>
                    </div>
                </div>

                <div class="costos-avanzados-container">
    <!-- Header con Toggle -->
    <div class="costos-avanzados-header" onclick="toggleCostosAvanzados()">
        <div class="costos-avanzados-title">
            <span>üìä</span>
            <span>Costos Avanzados - Desglose Detallado</span>
        </div>
        <span class="toggle-icon collapsed" id="toggleIconAvanzados">‚ñº</span>
    </div>
    
    <!-- Contenido Desplegable -->
    <div class="costos-avanzados-content" id="costosAvanzadosContent">
        
        <!-- Secci√≥n 1: Costos por Unidad Individual -->
        <div class="desglose-section">
            <h3 class="desglose-title">üîß Costos por Unidad Individual</h3>
            <div class="desglose-grid">
                <div class="desglose-item">
                    <span class="desglose-label">üè≠ Costo Fabricaci√≥n:</span>
                    <span class="desglose-value" id="desgloseCostoFabricacion">$0</span>
                </div>
                <div class="desglose-item desglose-sub">
                    <span class="desglose-label">‚Ä¢ Costo unitario filamento:</span>
                    <span class="desglose-value" id="desgloseCostoUnitario">$0/g</span>
                </div>
                <div class="desglose-item desglose-sub">
                    <span class="desglose-label">‚Ä¢ Factor de seguridad:</span>
                    <span class="desglose-value" id="desgloseFactorSeguridad">1.0x</span>
                </div>
                
                <div class="desglose-item">
                    <span class="desglose-label">‚ö° Costo Energ√≠a:</span>
                    <span class="desglose-value" id="desgloseCostoEnergia">$0</span>
                </div>
                <div class="desglose-item desglose-sub">
                    <span class="desglose-label">‚Ä¢ Tiempo de impresi√≥n:</span>
                    <span class="desglose-value" id="desgloseTiempoImpresion">0 min</span>
                </div>
                <div class="desglose-item desglose-sub">
                    <span class="desglose-label">‚Ä¢ Costo por hora:</span>
                    <span class="desglose-value" id="desgloseCostoKWH">$0/h</span>
                </div>
                
                <div class="desglose-item">
                    <span class="desglose-label">üé® Costo Dise√±o:</span>
                    <span class="desglose-value" id="desgloseCostoDiseno">$0</span>
                </div>
                <div class="desglose-item desglose-sub">
                    <span class="desglose-label">‚Ä¢ Horas de dise√±o:</span>
                    <span class="desglose-value" id="desgloseHorasDiseno">0h</span>
                </div>
                <div class="desglose-item desglose-sub">
                    <span class="desglose-label">‚Ä¢ Distribuido entre:</span>
                    <span class="desglose-value" id="desglosePiezasDiseno">1 pieza</span>
                </div>
                
                <div class="desglose-item">
                    <span class="desglose-label">üîß Depreciaci√≥n M√°quina:</span>
                    <span class="desglose-value" id="desgloseDepreciacion">$0</span>
                </div>
                <div class="desglose-item desglose-sub">
                    <span class="desglose-label">‚Ä¢ Valor m√°quina:</span>
                    <span class="desglose-value" id="desgloseValorMaquina">$1.400.000</span>
                </div>
                <div class="desglose-item desglose-sub">
                    <span class="desglose-label">‚Ä¢ Vida √∫til:</span>
                    <span class="desglose-value" id="desgloseVidaUtil">3 a√±os</span>
                </div>
            </div>
        </div>
        
        <div class="separator-line"></div>
        
        <!-- Secci√≥n 2: Subtotal y Gastos -->
        <div class="desglose-section">
            <h3 class="desglose-title">üíµ Subtotal y Gastos Adicionales</h3>
            <div class="desglose-grid">
                <div class="desglose-item highlight-warning">
                    <span class="desglose-label"><strong>üìä Subtotal Base:</strong></span>
                    <span class="desglose-value" id="desgloseSubtotal">$0</span>
                </div>
                
                <div class="desglose-item">
                    <span class="desglose-label">üìà GIF (Gastos Indirectos):</span>
                    <span class="desglose-value" id="desgloseCostoGIF">$0</span>
                </div>
                <div class="desglose-item desglose-sub">
                    <span class="desglose-label">‚Ä¢ Porcentaje aplicado:</span>
                    <span class="desglose-value" id="desglosePorcentajeGIF">15%</span>
                </div>
                
                <div class="desglose-item">
                    <span class="desglose-label">üè¢ AIU (Admin, Imprevistos, Utilidad):</span>
                    <span class="desglose-value" id="desgloseCostoAIU">$0</span>
                </div>
                <div class="desglose-item desglose-sub">
                    <span class="desglose-label">‚Ä¢ Porcentaje aplicado:</span>
                    <span class="desglose-value" id="desglosePorcentajeAIU">25%</span>
                </div>
                
                <div class="desglose-item" id="desgloseMarcaAguaItem" style="display: none;">
                    <span class="desglose-label">üíß Marca de Agua:</span>
                    <span class="desglose-value" id="desgloseCostoMarcaAgua">$0</span>
                </div>
                <div class="desglose-item desglose-sub" id="desgloseMarcaAguaPorcentaje" style="display: none;">
                    <span class="desglose-label">‚Ä¢ Porcentaje aplicado:</span>
                    <span class="desglose-value" id="desglosePorcentajeMarcaAgua">0%</span>
                </div>
            </div>
        </div>
        
        <div class="separator-line"></div>
        
        <!-- Secci√≥n 3: Precio Final por Unidad -->
        <div class="desglose-section">
            <h3 class="desglose-title">üí∞ Precio Final por Unidad</h3>
            <div class="desglose-grid">
                <div class="desglose-item highlight-primary">
                    <span class="desglose-label"><strong>üíµ Precio Base por Unidad:</strong></span>
                    <span class="desglose-value" id="desglosePrecioBase">$0</span>
                </div>
                <div class="desglose-item desglose-sub">
                    <span class="desglose-label">‚Ä¢ Piezas por lote:</span>
                    <span class="desglose-value" id="desglosePiezasPorLote">1</span>
                </div>
            </div>
        </div>
        
        <div class="separator-line"></div>
        
        <!-- Secci√≥n 4: Costos por Lote -->
        <div class="desglose-section">
            <h3 class="desglose-title">üì¶ Costos por Lote</h3>
            <div class="desglose-grid">
                <div class="desglose-item">
                    <span class="desglose-label">Piezas por lote:</span>
                    <span class="desglose-value" id="desglosePiezasLote">1</span>
                </div>
                <div class="desglose-item highlight-warning">
                    <span class="desglose-label"><strong>Costo por Lote:</strong></span>
                    <span class="desglose-value" id="desgloseCostoPorLote">$0</span>
                </div>
            </div>
        </div>
        
        <div class="separator-line"></div>
        
        <!-- Secci√≥n 5: Precios por Canal -->
        <div class="desglose-section">
            <h3 class="desglose-title">üìà Precios por Canal de Venta</h3>
            <div class="desglose-grid">
                <div class="desglose-item">
                    <span class="desglose-label">üè™ Precio Minorista:</span>
                    <span class="desglose-value" id="desglosePrecioMinorista">$0</span>
                </div>
                <div class="desglose-item desglose-sub">
                    <span class="desglose-label">‚Ä¢ Margen aplicado:</span>
                    <span class="desglose-value" id="desgloseMargenMinorista">30%</span>
                </div>
                
                <div class="desglose-item">
                    <span class="desglose-label">üè¢ Precio Mayorista:</span>
                    <span class="desglose-value" id="desglosePrecioMayorista">$0</span>
                </div>
                <div class="desglose-item desglose-sub">
                    <span class="desglose-label">‚Ä¢ Margen aplicado:</span>
                    <span class="desglose-value" id="desgloseMargenMayorista">20%</span>
                </div>
            </div>
        </div>
        
        <div class="separator-line"></div>
        
        <!-- Secci√≥n 6: Totales del Pedido -->
        <div class="desglose-section">
            <h3 class="desglose-title">üì¶ Totales del Pedido Completo</h3>
            <div class="desglose-grid">
                <div class="desglose-item">
                    <span class="desglose-label">Cantidad total de piezas:</span>
                    <span class="desglose-value" id="desgloseCantidadTotal">1</span>
                </div>
                <div class="desglose-item">
                    <span class="desglose-label">N√∫mero de lotes:</span>
                    <span class="desglose-value" id="desgloseNumeroLotes">1</span>
                </div>
                <div class="desglose-item">
                    <span class="desglose-label">Tiempo total de impresi√≥n:</span>
                    <span class="desglose-value" id="desgloseTiempoTotal">0h</span>
                </div>
                <div class="desglose-item">
                    <span class="desglose-label">Filamento total necesario:</span>
                    <span class="desglose-value" id="desgloseFilamentoTotal">0g</span>
                </div>
                <div class="desglose-item highlight-success">
                    <span class="desglose-label"><strong>üí∞ COSTO TOTAL DEL PEDIDO:</strong></span>
                    <span class="desglose-value"><strong id="desgloseCostoTotalPedido">$0</strong></span>
                </div>
                <div class="desglose-item">
                    <span class="desglose-label">üí∞ Total Minorista:</span>
                    <span class="desglose-value" id="desgloseTotalMinorista">$0</span>
                </div>
                <div class="desglose-item">
                    <span class="desglose-label">üí∞ Total Mayorista:</span>
                    <span class="desglose-value" id="desgloseTotalMayorista">$0</span>
                </div>
            </div>
        </div>
        
    </div>
                </div>

                <!-- Resumen de Pedido -->
                <div class="order-summary">
                    <h3>üìã Resumen del Pedido</h3>
                    <div class="summary-item">
                        <span>Cantidad Total:</span>
                        <span id="resumenCantidad">1 pieza</span>
                    </div>
                    <div class="summary-item">
                        <span>N√∫mero de Lotes:</span>
                        <span id="resumenLotes">1 lote</span>
                    </div>
                    <div class="summary-item highlight">
                        <span>üí∞ Costo Total (Base):</span>
                        <span id="resumenCostoTotal">$0</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts existentes -->
    <script src="js/config.js"></script>
    <script src="js/main.js"></script>
    <script src="js/cotizacion.js"></script>
    
    <!-- NUEVO: Script de integraci√≥n Kiri:Moto -->
    <script src="js/kirimoto-integration.js"></script>
    
    <!-- NUEVO: Script de redimensionamiento de paneles -->
    <script src="js/resizer.js"></script>
    
    <!-- NUEVO: Script del m√≥dulo de selecci√≥n de filamento -->
    <script src="js/cotizacion_filamento.js"></script>

    <script src="js/postprocesado.js"></script>
</body>
</html>